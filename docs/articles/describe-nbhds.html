<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Describing neighborhoods • ForestPlotR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Describing neighborhoods">
<meta property="og:description" content="ForestPlotR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ForestPlotR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data-format.html">Data formatting</a>
    </li>
    <li>
      <a href="../articles/describe-nbhds.html">Describing neighborhoods</a>
    </li>
    <li>
      <a href="../articles/growth-calc.html">Calculating growth rates</a>
    </li>
    <li>
      <a href="../articles/model-growth.html">Modeling tree growth and mortality</a>
    </li>
    <li>
      <a href="../articles/nbhd_size.html">Selecting neighborhood size</a>
    </li>
    <li>
      <a href="../articles/visualizations.html">Visualizing mapped stands</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sgraham9319/ForestPlotR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="describe-nbhds_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Describing neighborhoods</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sgraham9319/ForestPlotR/blob/master/vignettes/describe-nbhds.Rmd"><code>vignettes/describe-nbhds.Rmd</code></a></small>
      <div class="hidden name"><code>describe-nbhds.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sgraham9319.github.io/ForestPlot/">ForestPlotR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<p>This vignette describes a series of functions in the ForestPlotR package that provide quantitative descriptions of local neighborhoods in mapped forest stands. The neighborhood of a specific location in a mapped stand is the collection of trees growing within a specified distance of that location.</p>
<p>Of these functions, <code><a href="../reference/neighborhoods.html">neighborhoods()</a></code> constructs the list of all trees in each neighborhood. <code><a href="../reference/neighborhood_summary.html">neighborhood_summary()</a></code> takes the output of <code><a href="../reference/neighborhoods.html">neighborhoods()</a></code> as input and calculates tree species richness and species-specific densities for each neighborhood. <code><a href="../reference/site_by_species.html">site_by_species()</a></code> also takes the output of <code><a href="../reference/neighborhoods.html">neighborhoods()</a></code> as input but creates a site-by-species matrix, where each site is a different neighborhood, that can be used to calculate diversity metrics. <code><a href="../reference/tree_utm.html">tree_utm()</a></code> takes a mapping object as input and calculates UTM coordinates for each tree, thereby allowing trees to be linked to fine-scale spatial data such as topography.</p>
<div id="neighborhoods-construct-neighborhoods" class="section level2">
<h2 class="hasAnchor">
<a href="#neighborhoods-construct-neighborhoods" class="anchor"></a><code>neighborhoods()</code>: Construct neighborhoods</h2>
<p>The <code><a href="../reference/neighborhoods.html">neighborhoods()</a></code> function uses a mapping dataset to determine, for each tree, all the trees that are within a certain distance (<code>radius</code>). The argument <code>stand</code> can be used to indicate that neighborhoods should be constructed only for the trees of one or more of the stands included in <code>mapping</code>. If <code>stand</code> is not specified, neighborhoods will be constructed for all trees in <code>mapping</code>.</p>
<p>The output is a data frame where each row contains information on a focal tree and one other tree growing in the focal tree’s neighborhood. Therefore, the information for each focal tree will appear on <em>x</em> lines, where <em>x</em> is the number of trees in that focal tree’s neighborhood. This structure is shown below by isolating a single focal tree in the output of applying <code><a href="../reference/neighborhoods.html">neighborhoods()</a></code> to the built-in <code>mapping</code> dataset:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nbhds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/neighborhoods.html">neighborhoods</a></span><span class="op">(</span><span class="va">mapping</span>, stand <span class="op">=</span> <span class="st">"AB08"</span>, radius <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">nbhds</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">tree_id</span> <span class="op">==</span> <span class="st">"AB08000100022"</span><span class="op">)</span>
<span class="co">#&gt;         tree_id stand_id species  dbh      abh x_coord y_coord       id_comp</span>
<span class="co">#&gt; 1 AB08000100022     AB08    TSHE 15.1 179.0786   18.11   95.68 AB08000100001</span>
<span class="co">#&gt; 2 AB08000100022     AB08    TSHE 15.1 179.0786   18.11   95.68 AB08000100002</span>
<span class="co">#&gt; 3 AB08000100022     AB08    TSHE 15.1 179.0786   18.11   95.68 AB08000100003</span>
<span class="co">#&gt; 4 AB08000100022     AB08    TSHE 15.1 179.0786   18.11   95.68 AB08000100004</span>
<span class="co">#&gt; 5 AB08000100022     AB08    TSHE 15.1 179.0786   18.11   95.68 AB08000100005</span>
<span class="co">#&gt; 6 AB08000100022     AB08    TSHE 15.1 179.0786   18.11   95.68 AB08000100007</span>
<span class="co">#&gt; 7 AB08000100022     AB08    TSHE 15.1 179.0786   18.11   95.68 AB08000100017</span>
<span class="co">#&gt;       prox sps_comp dbh_comp  abh_comp</span>
<span class="co">#&gt; 1 6.423161     TSHE     50.4 1995.0370</span>
<span class="co">#&gt; 2 6.079679     TSHE     81.1 5165.7287</span>
<span class="co">#&gt; 3 4.925627     TSHE     20.0  314.1593</span>
<span class="co">#&gt; 4 5.221571     TSHE     53.7 2264.8448</span>
<span class="co">#&gt; 5 7.283028     TSHE     24.4  467.5947</span>
<span class="co">#&gt; 6 7.504265     THPL     57.0 2551.7586</span>
<span class="co">#&gt; 7 6.124255     TSHE     24.6  475.2916</span></code></pre></div>
<p>The <code><a href="../reference/neighborhoods.html">neighborhoods()</a></code> function can also be used to construct neighborhoods for specific coordinates within the mapped stand instead of constructing a neighborhood centered on each tree in the dataset. This is achieved by providing a data frame of coordinates under the optional argument <code>coords</code> (see <code><a href="../reference/neighborhoods.html">neighborhoods()</a></code> documentation for details on how this data frame should be structured).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a data frame of coordinates</span>
<span class="va">locations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  loc_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">81</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,
  x_coord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">90</span>, <span class="fl">10</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,
  y_coord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">90</span>, <span class="fl">10</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Construct neighborhood for each coordinate</span>
<span class="va">coord_nbhds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/neighborhoods.html">neighborhoods</a></span><span class="op">(</span><span class="va">mapping</span>, stands <span class="op">=</span> <span class="st">"AB08"</span>, radius <span class="op">=</span> <span class="fl">10</span>,
                             coords <span class="op">=</span> <span class="va">locations</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">coord_nbhds</span><span class="op">)</span>
<span class="co">#&gt;   loc_id stand_id x_coord y_coord       id_comp     prox sps_comp dbh_comp</span>
<span class="co">#&gt; 1     A1     AB08      10      10 AB08001600008 6.144689     TSHE     20.2</span>
<span class="co">#&gt; 2     A1     AB08      10      10 AB08001600009 7.062294     TSHE     68.2</span>
<span class="co">#&gt; 3     A1     AB08      10      10 AB08001600010 9.539193     TSHE     55.4</span>
<span class="co">#&gt; 4     A1     AB08      10      10 AB08001600011 2.344462     TSHE     17.5</span>
<span class="co">#&gt; 5     A1     AB08      10      10 AB08001600012 2.979564     TSHE     59.7</span>
<span class="co">#&gt; 6     A1     AB08      10      10 AB08001600013 4.928539     PSME     72.5</span>
<span class="co">#&gt;    abh_comp</span>
<span class="co">#&gt; 1  320.4739</span>
<span class="co">#&gt; 2 3653.0754</span>
<span class="co">#&gt; 3 2410.5126</span>
<span class="co">#&gt; 4  240.5282</span>
<span class="co">#&gt; 5 2799.2297</span>
<span class="co">#&gt; 6 4128.2491</span></code></pre></div>
</div>
<div id="neighborhood_summary-summarize-neighborhoods" class="section level2">
<h2 class="hasAnchor">
<a href="#neighborhood_summary-summarize-neighborhoods" class="anchor"></a><code>neighborhood_summary()</code>: Summarize neighborhoods</h2>
<p>The <code><a href="../reference/neighborhood_summary.html">neighborhood_summary()</a></code> function takes output of the <code><a href="../reference/neighborhoods.html">neighborhoods()</a></code> function and calculates species diversity metrics, overall tree density, and densities of each tree species for each neighborhood. Diversity metrics include species richness, Shannon-Wiener diversity, Simpson’s diversity, and evenness (Pielou’s J).</p>
<p>The <code>densities</code> argument is used to specify how densities should be calculated. The optimal method for density calculation is likely to vary between study systems and processes of interest. If the differential effects of neighbor tree species are likely to be influenced by how close the neighbors of each species are to the focal (e.g. when differences relate to competition for soil moisture or nutrients), the <code>angular</code> method may be more appropriate. However, if the forest is in the vertical diversification stage of successional development, the influence of a large canopy-forming neighbor species may be relatively unaffected by whether neighbors of that species are 5m vs. 10m from the focal tree - in this case the <code>raw</code> or <code>proportional</code> measures may be more relevant.</p>
<p>There is also an option to correct the density values for neighborhoods that overlap the stand boundary. When <code>edge_correction = T</code>, the density and species richness values for neighborhoods that overlap the stand boundary will be multiplied according to the proportion of their neighborhood that lies beyond the stand boundary (species richness values are rounded to the nearest whole number). See function documentation for details.</p>
<div id="neighborhood_summarydensities-raw" class="section level3">
<h3 class="hasAnchor">
<a href="#neighborhood_summarydensities-raw" class="anchor"></a><code>neighborhood_summary(densities = "raw")</code>
</h3>
<p>Overall tree density and species-specific densities will be presented in units of <span class="math inline">\(m^{2}ha^{-1}\)</span>, with the area occupied by each tree calculated as the area of the trunk at breast height i.e. <span class="math display">\[\pi(\frac{dbh}{2})^{2}\]</span></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nbhd_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/neighborhood_summary.html">neighborhood_summary</a></span><span class="op">(</span><span class="va">nbhds</span>, id_column <span class="op">=</span> <span class="st">"tree_id"</span>, radius <span class="op">=</span> <span class="fl">10</span>,
                                  densities <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span>
<span class="va">nbhd_summ</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tree_id</span>, <span class="va">sps_richness</span>, <span class="va">shannon</span>, <span class="va">ABAM_density</span>, <span class="va">TSHE_density</span>, <span class="va">all_density</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 401 x 6</span>
<span class="co">#&gt;   tree_id       sps_richness shannon ABAM_density TSHE_density all_density</span>
<span class="co">#&gt;   &lt;chr&gt;                &lt;int&gt;   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 AB08000100022            2   0.490         0            34.0        42.1</span>
<span class="co">#&gt; 2 AB08000100001            3   0.808         2.27         21.0        31.4</span>
<span class="co">#&gt; 3 AB08000100002            3   0.847         2.27         18.1        28.5</span>
<span class="co">#&gt; 4 AB08000100003            3   0.809         2.27         29.2        47.3</span>
<span class="co">#&gt; # ... with 397 more rows</span></code></pre></div>
</div>
<div id="neighborhood_summarydensities-proportional" class="section level3">
<h3 class="hasAnchor">
<a href="#neighborhood_summarydensities-proportional" class="anchor"></a><code>neighborhood_summary(densities = "proportional")</code>
</h3>
<p>Overall tree density is presented in units of <span class="math inline">\(m^{2}ha^{-1}\)</span> but species-specific densities represent the proportion of overall tree density that each species accounts for.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nbhd_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/neighborhood_summary.html">neighborhood_summary</a></span><span class="op">(</span><span class="va">nbhds</span>, id_column <span class="op">=</span> <span class="st">"tree_id"</span>, radius <span class="op">=</span> <span class="fl">10</span>,
                                  densities <span class="op">=</span> <span class="st">"proportional"</span><span class="op">)</span>
<span class="va">nbhd_summ</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tree_id</span>, <span class="va">sps_richness</span>, <span class="va">shannon</span>, <span class="va">ABAM_density</span>, <span class="va">TSHE_density</span>, <span class="va">all_density</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 401 x 6</span>
<span class="co">#&gt;   tree_id       sps_richness shannon ABAM_density TSHE_density all_density</span>
<span class="co">#&gt;   &lt;chr&gt;                &lt;int&gt;   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 AB08000100022            2   0.490       0             0.807        42.1</span>
<span class="co">#&gt; 2 AB08000100001            3   0.808       0.0721        0.669        31.4</span>
<span class="co">#&gt; 3 AB08000100002            3   0.847       0.0794        0.636        28.5</span>
<span class="co">#&gt; 4 AB08000100003            3   0.809       0.0479        0.618        47.3</span>
<span class="co">#&gt; # ... with 397 more rows</span></code></pre></div>
</div>
<div id="neighborhood_summarydensities-angular" class="section level3">
<h3 class="hasAnchor">
<a href="#neighborhood_summarydensities-angular" class="anchor"></a><code>neighborhood_summary(densities = "angular")</code>
</h3>
<p>Overall tree density and species-specific densities calculated as the sum of angles occupied by trees, where the angle occupied by a single tree is: <span class="math display">\[arctan(\frac{dbh}{distance})\]</span> In the above, <code>dbh</code> is the dbh of the neighbor tree and <code>distance</code> is the distance from the neighborhood center to the neighbor tree.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nbhd_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/neighborhood_summary.html">neighborhood_summary</a></span><span class="op">(</span><span class="va">nbhds</span>, id_column <span class="op">=</span> <span class="st">"tree_id"</span>, radius <span class="op">=</span> <span class="fl">10</span>,
                                  densities <span class="op">=</span> <span class="st">"angular"</span><span class="op">)</span>
<span class="va">nbhd_summ</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tree_id</span>, <span class="va">sps_richness</span>, <span class="va">shannon</span>, <span class="va">ABAM_angle_sum</span>, <span class="va">TSHE_angle_sum</span>,
         <span class="va">all_angle_sum</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 401 x 6</span>
<span class="co">#&gt;   tree_id       sps_richness shannon ABAM_angle_sum TSHE_angle_sum all_angle_sum</span>
<span class="co">#&gt;   &lt;chr&gt;                &lt;int&gt;   &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 AB08000100022            2   0.490         0               0.428         0.503</span>
<span class="co">#&gt; 2 AB08000100001            3   0.808         0.0379          0.671         0.779</span>
<span class="co">#&gt; 3 AB08000100002            3   0.847         0.0323          0.530         0.626</span>
<span class="co">#&gt; 4 AB08000100003            3   0.809         0.0391          0.509         0.805</span>
<span class="co">#&gt; # ... with 397 more rows</span></code></pre></div>
</div>
<div id="neighborhood_summaryneighbors_incl-larger_only" class="section level3">
<h3 class="hasAnchor">
<a href="#neighborhood_summaryneighbors_incl-larger_only" class="anchor"></a><code>neighborhood_summary(neighbors_incl = "larger_only")</code>
</h3>
<p>It is also possible to restrict the diversity and density calculations to include only the neighbor trees that are larger than the focal. This may be useful if trees in the study system are expected to compete far less strongly with neighbors that are smaller than them.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nbhd_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/neighborhood_summary.html">neighborhood_summary</a></span><span class="op">(</span><span class="va">nbhds</span>, id_column <span class="op">=</span> <span class="st">"tree_id"</span>, radius <span class="op">=</span> <span class="fl">10</span>,
                                  densities <span class="op">=</span> <span class="st">"angular"</span>,
                                  neighbors_incl <span class="op">=</span> <span class="st">"larger_only"</span><span class="op">)</span>
<span class="va">nbhd_summ</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tree_id</span>, <span class="va">sps_richness</span>, <span class="va">shannon</span>, <span class="va">ABAM_angle_sum</span>, <span class="va">TSHE_angle_sum</span>,
         <span class="va">all_angle_sum</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 364 x 6</span>
<span class="co">#&gt;   tree_id       sps_richness shannon ABAM_angle_sum TSHE_angle_sum all_angle_sum</span>
<span class="co">#&gt;   &lt;chr&gt;                &lt;int&gt;   &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 AB08000100022            2   0.490         0               0.428         0.503</span>
<span class="co">#&gt; 2 AB08000100001            2   0.635         0               0.535         0.606</span>
<span class="co">#&gt; 3 AB08000100003            3   0.813         0.0391          0.479         0.774</span>
<span class="co">#&gt; 4 AB08000100004            1   0             0               0.174         0.174</span>
<span class="co">#&gt; # ... with 360 more rows</span></code></pre></div>
</div>
</div>
<div id="site_by_species-create-site-by-species-matrices" class="section level2">
<h2 class="hasAnchor">
<a href="#site_by_species-create-site-by-species-matrices" class="anchor"></a><code>site_by_species()</code>: Create site-by-species matrices</h2>
<p>The <code><a href="../reference/site_by_species.html">site_by_species()</a></code> function takes output of the <code><a href="../reference/neighborhoods.html">neighborhoods()</a></code> function and creates a site-by-species matrix where each site is a neighborhood. The resulting matrix can be used as input for functions in other packages (e.g. picante, vegan) that calculate various diversity metrics from site-by-species matrices.</p>
<p>The default is to present presence/absence data in the matrix:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ss_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_by_species.html">site_by_species</a></span><span class="op">(</span><span class="va">nbhds</span>, id_column <span class="op">=</span> <span class="st">"tree_id"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ss_mat</span><span class="op">)</span>
<span class="co">#&gt;               ABAM ABPR CANO PSME TABR THPL TSHE</span>
<span class="co">#&gt; AB08000100022    0    0    0    0    0    1    1</span>
<span class="co">#&gt; AB08000100001    1    0    0    0    0    1    1</span>
<span class="co">#&gt; AB08000100002    1    0    0    0    0    1    1</span>
<span class="co">#&gt; AB08000100003    1    0    0    0    0    1    1</span>
<span class="co">#&gt; AB08000100004    0    0    0    0    0    0    1</span>
<span class="co">#&gt; AB08000100005    1    0    0    0    0    1    1</span></code></pre></div>
<p>But if <code>abundance = T</code> is specified, matrix element values will represent the number of trees of the associated species in the neighborhood:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ss_mat_abund</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_by_species.html">site_by_species</a></span><span class="op">(</span><span class="va">nbhds</span>, id_column <span class="op">=</span> <span class="st">"tree_id"</span>, abundance <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ss_mat_abund</span><span class="op">)</span>
<span class="co">#&gt;               ABAM ABPR CANO PSME TABR THPL TSHE</span>
<span class="co">#&gt; AB08000100022    0    0    0    0    0    1    6</span>
<span class="co">#&gt; AB08000100001    1    0    0    0    0    1    5</span>
<span class="co">#&gt; AB08000100002    1    0    0    0    0    1    6</span>
<span class="co">#&gt; AB08000100003    1    0    0    0    0    2    7</span>
<span class="co">#&gt; AB08000100004    0    0    0    0    0    0    3</span>
<span class="co">#&gt; AB08000100005    1    0    0    0    0    2    8</span></code></pre></div>
</div>
<div id="tree_utm-calculate-tree-utm-coordinates" class="section level2">
<h2 class="hasAnchor">
<a href="#tree_utm-calculate-tree-utm-coordinates" class="anchor"></a><code>tree_utm()</code>: Calculate tree UTM coordinates</h2>
<p>The <code><a href="../reference/tree_utm.html">tree_utm()</a></code> function takes a mapping object as input and calculates UTM coordinates for each tree. The output spatial object can be used to extract further data for each tree from data sources with very high spatial resolution e.g. topography.</p>
<p>The required arguments for <code><a href="../reference/tree_utm.html">tree_utm()</a></code> are: geographic coordinates of the stands (<code>stand_locs</code>), the ESPG code of the coordinate reference system of <code>stand_locs</code> (<code>original_crs</code>), and the ESPG code of the UTM zone in which the stands exist (<code>utm_crs</code>).</p>
<p>The built-in <code>stand_locations</code> dataset shows the expected structure of <code>stand_locs</code> - see <code><a href="../reference/stand_locations.html">?stand_locations</a></code> for details:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">stand_locations</span><span class="op">)</span>
<span class="co">#&gt;   stand_id y_azim latitude longitude</span>
<span class="co">#&gt; 1     TO04  12.58 46.74002 -121.8887</span>
<span class="co">#&gt; 2     TB13  90.99 46.74086 -121.8487</span>
<span class="co">#&gt; 3     AX15 298.32 46.74979 -121.8242</span>
<span class="co">#&gt; 4     AG05  84.42 46.74765 -121.8052</span>
<span class="co">#&gt; 5     AV06  45.74 46.77602 -121.7851</span>
<span class="co">#&gt; 6     AM16  58.80 46.76848 -121.7585</span></code></pre></div>
<p>The output of <code><a href="../reference/tree_utm.html">tree_utm()</a></code> looks like the following:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping_utm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tree_utm.html">tree_utm</a></span><span class="op">(</span><span class="va">mapping</span>, <span class="va">stand_locations</span>, <span class="fl">4326</span>, <span class="fl">32610</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mapping_utm</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 6 features and 8 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 611415.1 ymin: 5197317 xmax: 611421.6 ymax: 5197329</span>
<span class="co">#&gt; Projected CRS: WGS 84 / UTM zone 10N</span>
<span class="co">#&gt;         tree_id stand_id  tag species year  dbh x_coord y_coord</span>
<span class="co">#&gt; 1 AB08000100022     AB08   19    TSHE 2012 15.1   18.11   95.68</span>
<span class="co">#&gt; 2 AB08000100001     AB08 4001    TSHE 2012 50.4   11.78   96.77</span>
<span class="co">#&gt; 3 AB08000100002     AB08 4002    TSHE 2012 81.1   12.47   97.95</span>
<span class="co">#&gt; 4 AB08000100003     AB08 4003    TSHE 2012 20.0   14.94   91.91</span>
<span class="co">#&gt; 5 AB08000100004     AB08 4004    TSHE 2012 53.7   22.09   99.06</span>
<span class="co">#&gt; 6 AB08000100005     AB08 4005    TSHE 2012 24.4   12.16   91.48</span>
<span class="co">#&gt;                   geometry</span>
<span class="co">#&gt; 1 POINT (611417.2 5197322)</span>
<span class="co">#&gt; 2 POINT (611420.8 5197327)</span>
<span class="co">#&gt; 3 POINT (611421.6 5197326)</span>
<span class="co">#&gt; 4 POINT (611415.1 5197326)</span>
<span class="co">#&gt; 5 POINT (611418.6 5197317)</span>
<span class="co">#&gt; 6 POINT (611415.9 5197329)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/sgraham9319">Stuart Graham</a>, <a href="https://github.com/arokem">Ariel Rokem</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
